---
import type { Sponsor } from '@/lib/sanity';
import { Section } from '@/components/ui/section';
import { stegaClean } from '@sanity/client/stega';
import { safeUrlFor } from '@/lib/image';

interface Props {
  heading?: string | null;
  autoPopulate?: boolean | null;
  sponsors?: Sponsor[];
  class?: string;
  id?: string;
  [key: string]: unknown;
}

const { heading, sponsors } = Astro.props;
---

<Section size="sm" class="bg-muted border-y border-border" data-animate>
  {heading && (
    <div class="text-center">
      <span class="label-caps text-muted-foreground">{heading}</span>
    </div>
  )}

  <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-px bg-border">
    {sponsors?.map((sponsor) => {
      const logoUrl = safeUrlFor(sponsor.logo)?.width(120).height(40).fit('max').url() ?? null;
      const content = (
        <div class="bg-muted p-6 flex items-center justify-center h-24 hover:bg-background transition-colors duration-200">
          {logoUrl ? (
            <img src={logoUrl} alt={sponsor.name} class="max-h-10 max-w-[120px] opacity-60 hover:opacity-100 transition-opacity" width="120" height="40" loading="lazy" />
          ) : (
            <span class="text-sm font-bold text-muted-foreground text-center leading-tight tracking-tight">{sponsor.name}</span>
          )}
        </div>
      );

      return sponsor.website ? (
        <a href={stegaClean(sponsor.website)} target="_blank" rel="noopener">
          {content}
        </a>
      ) : (
        content
      );
    })}
  </div>
</Section>
