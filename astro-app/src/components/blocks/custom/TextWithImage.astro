---
import type { TextWithImageBlock } from '@/lib/types';
import { Section, SectionSplit, SectionContent, SectionMedia } from '@/components/ui/section';
import { PortableText } from 'astro-portabletext';
import { stegaClean } from '@sanity/client/stega';

interface Props extends TextWithImageBlock {
  class?: string;
  id?: string;
}

const { heading, content, image, imagePosition } = Astro.props;
const isRight = stegaClean(imagePosition) !== 'left';
const imgSrc = image?.asset?.url;
---

<Section data-animate>
  <SectionSplit>
    <SectionContent class="justify-center">
      {heading && (
        <h2 class="text-3xl md:text-4xl font-bold tracking-[-0.03em] leading-[1.1]">{heading}</h2>
      )}
      {content && (
        <div class="text-muted-foreground leading-relaxed prose">
          <PortableText value={content} />
        </div>
      )}
    </SectionContent>

    <SectionMedia class={`aspect-[4/3] ${!isRight ? '@lg:order-first' : ''}`}>
      {imgSrc && (
        <img
          src={imgSrc}
          alt={image?.alt || heading || ''}
          class="w-full h-full object-cover"
          loading="lazy"
        />
      )}
    </SectionMedia>
  </SectionSplit>
</Section>
