---
import type { FaqSectionBlock } from '@/lib/types';
import { Section, SectionSplit, SectionContent } from '@/components/ui/section';
import { Accordion, AccordionItem, AccordionTrigger, AccordionContent } from '@/components/ui/accordion';
import { PortableText } from 'astro-portabletext';
import { portableTextComponents } from '@/components/portable-text';

interface Props extends FaqSectionBlock {
  class?: string;
  id?: string;
}

const { heading, items } = Astro.props;
---

<Section data-animate>
  <SectionSplit>
    <SectionContent>
      {heading && (
        <h2 class="text-4xl md:text-5xl font-bold tracking-[-0.03em] leading-[1.05] sticky top-24">{heading}</h2>
      )}
    </SectionContent>

    <Accordion>
      {(items ?? []).map((item, i) => (
        <AccordionItem id={item._key}>
          <AccordionTrigger>
            <span class="flex items-start gap-4">
              <span class="text-xs font-bold text-muted-foreground mt-0.5 flex-shrink-0">
                {String(i + 1).padStart(2, '0')}
              </span>
              <span>{item.question}</span>
            </span>
          </AccordionTrigger>
          <AccordionContent>
            {Array.isArray(item.answer)
              ? <div class="text-muted-foreground leading-relaxed pl-10 prose"><PortableText value={item.answer} components={portableTextComponents} /></div>
              : <p class="text-muted-foreground leading-relaxed pl-10">{item.answer}</p>}
          </AccordionContent>
        </AccordionItem>
      ))}
    </Accordion>
  </SectionSplit>
</Section>
