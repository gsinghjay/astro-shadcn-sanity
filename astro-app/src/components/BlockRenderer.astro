---
import type { PageBlock } from '@/lib/types';
import { customBlocks, uiBlocks } from './block-registry';
import BlockWrapper from './blocks/BlockWrapper.astro';

interface Props {
  blocks: PageBlock[];
}

const { blocks } = Astro.props;
---

{blocks.map((block) => {
  const type = (block as any)._type;

  // Custom blocks (block prop pattern)
  const CustomComponent = customBlocks[type];
  if (CustomComponent) {
    return <BlockWrapper backgroundVariant={(block as any).backgroundVariant} spacing={(block as any).spacing} maxWidth={(block as any).maxWidth}><CustomComponent block={block} /></BlockWrapper>;
  }

  // fulldotdev/ui blocks (spread props pattern)
  const UiComponent = uiBlocks[type];
  if (UiComponent) {
    return <BlockWrapper backgroundVariant={(block as any).backgroundVariant} spacing={(block as any).spacing} maxWidth={(block as any).maxWidth}><UiComponent {...(block as any)} /></BlockWrapper>;
  }

  return null;
})}
