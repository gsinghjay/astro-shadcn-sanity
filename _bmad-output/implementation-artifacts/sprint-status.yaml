# generated: 2026-02-10
# project: astro-shadcn-sanity
# project_key: NOKEY
# tracking_system: file-system
# story_location: /home/jay/github/astro-shadcn-sanity/_bmad-output/implementation-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog → in-progress: Automatically when first story is created (via create-story)
#   - in-progress → done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)
#
# CHANGE LOG:
# ===========
# 2026-02-07: Sprint Change Proposal approved
#   - Story 1.2 replaced: schema-infrastructure → migrate-reference-project
#   - Story 1.3 added (was 1.2): schema-infrastructure (renumbered)
#   - Story 1.4 replaced: mobile-navigation-and-breadcrumbs → storybook-setup
#   - Original 1.3 (layout/header/footer) absorbed into 1.2 migration
#   - Original 1.4 (mobile-nav/breadcrumbs) absorbed into 1.2 migration
#   - Epic 2 refocused: block schemas + Sanity integration (frontend from migration)
#   - Story 2.1 replaced: core-block-schemas (combines original 2.1-2.4 schema work)
#   - Story 2.2 replaced: groq-queries-and-page-data-fetching (new)
#   - Story 2.3 retained: page-composition-system
#   - Story 2.4 removed: absorbed into 2.1
#   - Epics 3-4 compressed: schema/GROQ focus only (frontend already migrated)
#   - Block naming: architecture camelCase names retained (heroBanner, ctaBanner, etc.)
#   - P0 blocks promoted: statsRow, textWithImage, teamGrid moved from P1 to P0
#
# 2026-02-08: Homepage-first delivery split
#   - Story 2.1 scoped to 6 homepage blocks only (heroBanner, featureGrid, ctaBanner, statsRow, textWithImage, logoCloud)
#   - Story 2.1b added: remaining 6 block schemas (richText, faqSection, contactForm, sponsorCards, timeline, teamGrid)
#   - Story 2.2 scoped to homepage GROQ queries and data fetching only
#   - Story 2.2b added: remaining pages GROQ queries and data fetching
#   - Story 3.1 created: sponsor document schema (homepage dependency for logoCloud)
#   - Homepage demo path: 2.1 → 3.1 → 2.2
#
# 2026-02-08: Storybook production build stories added
#   - Story 1.5 added: storybook-production-build (fix empty iframe in storybook build)
#   - Story 1.6 added: storybook-github-pages-deploy (deploy working build to GH Pages)
#   - Epic 1 reopened: in-progress (was done, new stories added)
#   - Story 1.6 blocked by 1.5
#
# 2026-02-09: Sprint status refresh
#   - Stories 2.4–2.8 added: fulldev/ui block Sanity schemas (5 parallel stories, 102 blocks total)
#   - Story 2.9 added: custom-block-fulldev-ui-conversion (unify block dispatch pattern)
#   - Story 5.2 renamed: GA4, Security Headers & Cloudflare Pages Deploy (was GitHub Pages)
#   - Story 5.3 added: Matomo self-hosted analytics on VPS (split from 5.2)
#   - Story 6.1 renamed: Contact Form with Formsite Integration (was custom Sanity API route)
#   - Epic 6 no longer deferred
#   - Story 2.2b upgraded: backlog → ready-for-dev (file exists)
#   - Story 6.1 upgraded: backlog → ready-for-dev (file exists)
#
# 2026-02-09: Epic 7 added (Sanity Code Quality & Type Safety)
#   - Source: Sanity Code Review (docs/code-review/sanity-code-review_20260209_130832.md)
#   - 5 stories addressing 18 review findings (1 Critical, 3 High, 4 Medium, 7 Low)
#   - Story 7.1: Fix visual editing (stegaClean + loadQuery) — Critical
#   - Story 7.2: Query completeness & defineQuery — High
#   - Story 7.3: Schema best practices — High+Medium
#   - Story 7.4: TypeGen & type replacement — High (blocked by 7.2)
#   - Story 7.5: Config & dead code cleanup — Low
#
# 2026-02-09: Story 5.4 added (Preview & Publish Architecture)
#   - New comprehensive story: webhook auto-rebuild, SSR cache fix, perspective deprecation
#   - Completes the content publishing loop (edit → preview → publish → auto-rebuild)
#   - Scope: Sanity webhook config, Cloudflare deploy hook, sanity.ts fixes
#   - Epic 5 remains in-progress
#   - Priority: before continuing Epic 2 stories 2.4–2.9
#
# 2026-02-10: Epic 7 updated from new Sanity code review
#   - Source: Sanity Code Review (2026-02-10) — _bmad-output/sanity-code-review.md
#   - Old Story 7.1 (Fix Visual Editing) removed — stegaClean/loadQuery issues now passing
#   - Old Story 7.5 (Config & Dead Code) removed — items not flagged in current review
#   - Stories reorganized from 5 to 4:
#   - NEW 7.1: Query completeness, defineQuery & SEO stega fix (combines old 7.2 + new findings)
#   - NEW 7.2: Schema best practices (reduced scope from old 7.3)
#   - NEW 7.3: TypeGen & type replacement (renumbered from old 7.4, blocked by 7.1)
#   - NEW 7.4: Server islands preview optimization (from existing artifact)
#
# 2026-02-10: Story 5.5 added (Cloudflare Native Preview Deployments)
#   - Migrate from GitHub Actions direct upload to Cloudflare Pages git integration
#   - Eliminates: preview branch, sync-main.yml, double builds, .env writing hack
#   - CF Pages dashboard handles Production vs Preview env vars
#   - GitHub Actions retained for CI only (tests/lint), not deployment
#   - Requires new CF Pages project (cannot migrate direct upload → git integration)
#   - Epic 5 remains in-progress

generated: 2026-02-10
project: astro-shadcn-sanity
project_key: NOKEY
tracking_system: file-system
story_location: /home/jay/github/astro-shadcn-sanity/_bmad-output/implementation-artifacts

development_status:
  epic-1: in-progress
  1-1-reconfigure-starter-and-set-up-design-system: done
  1-2-migrate-reference-project: done
  1-3-schema-infrastructure: done
  1-4-storybook-setup: done
  1-5-storybook-production-build: done
  1-6-storybook-github-pages-deploy: review
  epic-1-retrospective: optional

  epic-2: in-progress
  2-0-template-layout-system: done
  2-1-homepage-block-schemas: done
  2-1b-remaining-block-schemas: done
  2-2-homepage-data-fetching: done
  2-2b-remaining-pages-data-fetching: ready-for-dev
  2-3a-site-settings-wiring: done
  2-3-page-composition-system: ready-for-dev
  2-4-ui-blocks-hero-banner: ready-for-dev
  2-5-ui-blocks-content-articles: ready-for-dev
  2-6-ui-blocks-cta-features: ready-for-dev
  2-7-ui-blocks-products-services: ready-for-dev
  2-8-ui-blocks-media-misc: ready-for-dev
  2-9-custom-block-fulldev-ui-conversion: ready-for-dev
  epic-2-retrospective: optional

  epic-3: in-progress
  3-1-sponsor-document-schema-and-studio-management: ready-for-dev
  3-2-sponsor-cards-block-and-listing-page: backlog
  3-3-sponsor-detail-pages: backlog
  epic-3-retrospective: optional

  epic-4: backlog
  4-1-project-and-team-document-schemas: backlog
  4-2-event-document-schema-and-timeline-block: backlog
  4-3-project-listing-and-cross-reference-navigation: backlog
  epic-4-retrospective: optional

  epic-5: in-progress
  5-1-seo-metadata-and-sitemap: backlog
  5-2-ga4-security-headers-cloudflare-deploy: review
  5-3-matomo-self-hosted-vps: backlog
  5-4-preview-publish-architecture: in-progress
  5-5-cloudflare-native-preview-deployments: in-progress
  epic-5-retrospective: optional

  epic-6: backlog
  6-1-contact-form-formsite-integration: ready-for-dev
  epic-6-retrospective: optional

  epic-7: in-progress
  7-1-query-completeness-definequery-and-seo-stega-fix: review
  7-2-schema-best-practices: backlog
  7-3-typegen-and-type-replacement: backlog  # blocked by 7.1
  7-4-server-islands-preview-optimization: ready-for-dev
  epic-7-retrospective: optional
